<!DOCTYPE html>
<html>
  <head>
    <title>lrshiftwinact.au3.html 2015.11.15.20.24.32</title>
    <meta charset-"utf-8">
  </head>
  <body style="background-color:#000000;">
<div style='max-width: 850px;overflow:hidden; color: #d6d6d6;font-style: normal; font-weight: normal; text-decoration: none;'>
<pre><span style="color:#363250;">; #INDEX# =======================================================================================================================</span>
<span> </span><span style="color:#363250;">; Title .........: LRShiftWinAct v1.0.0.0</span>
<span> </span><span style="color:#363250;">; AutoIt Version : 3.3</span>
<span> </span><span style="color:#363250;">; Language ......: English (language independent)</span>
<span> </span><span style="color:#363250;">; Description ...: Switch windows quickly</span>
<span> </span><span style="color:#363250;">; Author(s) .....: MarkRobbins</span>
<span> </span><span style="color:#363250;">; Copyright .....: Copyright (C) Mark C Robbins. All rights reserved.</span>
<span> </span><span style="color:#363250;">; License .......: Artistic License 2.0, see Artistic.txt</span>
<span> </span><span style="color:#363250;">;</span>
<span> </span><span style="color:#363250;">; LRShiftWinAct is free software; you can redistribute it and/or modify</span>
<span> </span><span style="color:#363250;">; it under the terms of the Artistic License as published by Larry Wall,</span>
<span> </span><span style="color:#363250;">; either version 2.0, or (at your option) any later version.</span>
<span> </span><span style="color:#363250;">;</span>
<span> </span><span style="color:#363250;">; This program is distributed in the hope that it will be useful,</span>
<span> </span><span style="color:#363250;">; but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span> </span><span style="color:#363250;">; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span> </span><span style="color:#363250;">; See the Artistic License for more details.</span>
<span> </span><span style="color:#363250;">;</span>
<span> </span><span style="color:#363250;">; You should have received a copy of the Artistic License with this Kit,</span>
<span> </span><span style="color:#363250;">; in the file named &quot;Artistic.txt&quot;.  If not, you can get a copy from</span>
<span> </span><span style="color:#363250;">; &lt;http://www.perlfoundation.org/artistic_license_2_0&gt; OR</span>
<span> </span><span style="color:#363250;">; &lt;http://www.opensource.org/licenses/artistic-license-2.0.php&gt;</span>
<span> </span><span style="color:#363250;">;</span>
<span> </span><span style="color:#363250;">; ===============================================================================================================================</span>

<span style="color:#363250;">; #OVERVIEW# ===========================================================================================================</span>
<span> </span><span style="color:#363250;">; SOURCE_______________________________________________________________________________________________________________</span>
<span>  </span><span style="color:#363250;">; Organization ..: Mark Robbins and Associates</span>
<span>  </span><span style="color:#363250;">; Author ........: Mark Robbins</span>
<span> </span><span style="color:#363250;">; LOG__________________________________________________________________________________________________________________</span>
<span>  </span><span style="color:#363250;">; Created .......: 2015.11.15.20.22.06</span>
<span>  </span><span style="color:#363250;">; Modified ......: 2015.11.15.20.22.06</span>
<span>  </span><span style="color:#363250;">; Entries........: yyyy.mm.dd.hh.mm.ss Comments</span>
<span> </span><span style="color:#363250;">; HEADER_______________________________________________________________________________________________________________</span>
<span>  </span><span style="color:#363250;">; Type ..........: Activator Toolbar</span>
<span>  </span><span style="color:#363250;">; Subtype .......: Slider</span>
<span>  </span><span style="color:#363250;">; Name ..........: LRShiftWinAct</span>
<span>  </span><span style="color:#363250;">; Summary .......:</span>
<span>  </span><span style="color:#363250;">; Description ...: Switch windows quickly</span>
<span>  </span><span style="color:#363250;">;                  Press left and right shift, app appears, press number</span>
<span>  </span><span style="color:#363250;">; Remarks .......:</span>
<span> </span><span style="color:#363250;">; DEVELOPMENT__________________________________________________________________________________________________________</span>
<span>  </span><span style="color:#363250;">; Issues ........:</span>
<span>  </span><span style="color:#363250;">; Status ........: [X] New</span>
<span>  </span><span style="color:#363250;">;                  [ ] Open</span>
<span>  </span><span style="color:#363250;">;                  [ ] InProgress</span>
<span>  </span><span style="color:#363250;">;                  [ ] Resolved</span>
<span>  </span><span style="color:#363250;">;                  [ ] Closed</span>
<span> </span><span style="color:#363250;">; OTHER________________________________________________________________________________________________________________</span>
<span>  </span><span style="color:#363250;">; Related .......:</span>
<span>  </span><span style="color:#363250;">; Related Links .:</span>
<span>  </span><span style="color:#363250;">; Resources......:</span>
<span> </span><span style="color:#363250;">; =====================================================================================================================</span>

<span style="color:#808000;">#NoTrayIcon</span>
<span style="color:#808000;">#include</span><span> </span><span style="color:#708a53;">&lt;</span><span>Date.au3</span><span style="color:#708a53;">&gt;</span>
<span style="color:#808000;">#include</span><span> </span><span style="color:#708a53;">&lt;</span><span>Array.au3</span><span style="color:#708a53;">&gt;</span>
<span style="color:#808000;">#include</span><span> </span><span style="color:#708a53;">&lt;</span><span>File.au3</span><span style="color:#708a53;">&gt;</span>
<span style="color:#808000;">#include</span><span> </span><span style="color:#708a53;">&lt;</span><span>GUIConstantsEx.au3</span><span style="color:#708a53;">&gt;</span>
<span style="color:#808000;">#include</span><span> </span><span style="color:#708a53;">&lt;</span><span>WindowsConstants.au3</span><span style="color:#708a53;">&gt;</span>
<span style="color:#808000;">#include</span><span> </span><span style="color:#708a53;">&lt;</span><span>ButtonConstants.au3</span><span style="color:#708a53;">&gt;</span>
<span style="color:#808000;">#include</span><span> </span><span style="color:#708a53;">&lt;</span><span>StaticConstants.au3</span><span style="color:#708a53;">&gt;</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$thisfile</span><span>=</span><span style="color:#ff00ff;">@ScriptDir&amp;</span><span style="color:#939300;">&quot;\LRShiftWinAct.au3&quot;</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$logg</span><span>=</span><span style="color:#ff00ff;">@ScriptDir&amp;</span><span style="color:#939300;">&quot;\LRShiftWinAct-log1.txt&quot;</span><span style="color:#363250;">;</span>
<span style="color:#363250;">;e C:\batch\LRShiftWinAct-log.txt</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$timestamp</span><span>=</span><span style="color:#ff00ff;">@YEAR&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@MON&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@MDAY&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@HOUR&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@MIN&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@SEC&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@MSEC</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$testing</span><span>=</span><span style="color:#2b2bff;">False</span>


<span style="color:#2b2bff;">If</span><span> </span><span style="color:#634880;">$CmdLine</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span>&lt;&gt;</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>  </span><span style="color:#b2b2b2;">$testing</span><span>=</span><span style="color:#2b2bff;">False</span>
<span style="color:#2b2bff;">EndIf</span>

<span style="color:#2b2bff;">If</span><span> </span><span style="color:#ff00ff;">Not</span><span> </span><span style="color:#b2b2b2;">$testing</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#634880;">$CmdLine</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span>&lt;&gt;</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#3a7474;">Msg</span><span>(</span><span style="color:#7a7b62;">'&quot;Need 0 params - exiting&quot; &quot;'</span><span style="color:#ff00ff;">&amp;</span><span style="color:#b2b2b2;">$thisfile</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">Exit</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span style="color:#2b2bff;">Else</span>
<span>  </span><span style="color:#3a7474;">logclear</span><span>()</span>
<span style="color:#2b2bff;">EndIf</span>


<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$hDLL</span><span> = </span><span style="color:#006200;">DllOpen</span><span>(</span><span style="color:#939300;">&quot;user32.dll&quot;</span><span>)</span>
<span style="color:#006200;">OnAutoItExitRegister</span><span>(</span><span style="color:#939300;">&quot;OnAutoItExit&quot;</span><span>)</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$objWMIService</span><span> = </span><span style="color:#006200;">ObjGet</span><span> ( </span><span style="color:#7a7b62;">'winmgmts:\\localhost\root\CIMV2'</span><span> )</span>
<span style="color:#006200;">AutoItSetOption</span><span>(</span><span style="color:#939300;">&quot;GUICloseOnESC&quot;</span><span>,</span><span style="color:#8080ff;">0</span><span>)</span>


<span style="color:#363250;">; trigger</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$vk_trigger_l</span><span>=</span><span style="color:#8080ff;">0xA0</span><span style="color:#363250;">;left shift</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$vk_trigger_r</span><span>=</span><span style="color:#8080ff;">0xA1</span><span style="color:#363250;">;right shift</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$hwnds</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">10</span><span style="color:#708a53;">]</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$oColItems</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$hGui</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$btn_w</span><span>=</span><span style="color:#8080ff;">40</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$btn_h</span><span>=</span><span style="color:#8080ff;">40</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$app_title</span><span>=</span><span style="color:#939300;">&quot;Shift Key Window Activator&quot;</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$app_width</span><span>=</span><span style="color:#8080ff;">800</span><span style="color:#363250;">;$btn_w*13</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$app_height</span><span>=</span><span style="color:#b2b2b2;">$btn_h</span><span>*</span><span style="color:#8080ff;">10</span><span>+</span><span style="color:#8080ff;">50</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$app_x</span><span>=-</span><span style="color:#8080ff;">1</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$app_y</span><span>=-</span><span style="color:#b2b2b2;">$app_height</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$app_style</span><span>=</span><span style="color:#634880;">$WS_POPUP</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$app_ex_style</span><span>=-</span><span style="color:#8080ff;">1</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$app_parent</span><span>=</span><span style="color:#8080ff;">0</span><span style="color:#363250;">;WinGetHandle(&quot;Start&quot;)</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$in_step</span><span>=</span><span style="color:#8080ff;">50</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$out_step</span><span>=</span><span style="color:#8080ff;">60</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$app_hidden</span><span>=</span><span style="color:#8080ff;">1</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$app_home_y</span><span>=</span><span style="color:#8080ff;">30</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$GUIFADE_MAXTRANS</span><span> = </span><span style="color:#8080ff;">220</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$setting</span><span>=</span><span style="color:#2b2bff;">False</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$set_h</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$loopct</span><span>=</span><span style="color:#8080ff;">0</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$hwnd_c_t</span><span>=</span><span style="color:#8080ff;">0</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$hwnd_c_tu</span><span>=</span><span style="color:#8080ff;">0</span>


<span style="color:#363250;">;btnh,labelh,winh</span>
<span style="color:#363250;">;Global $btns[12][4]</span>

<span style="color:#363250;">;btnh,labelh2,winh</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">10</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">4</span><span style="color:#708a53;">]</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">10</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">4</span><span style="color:#708a53;">]</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">10</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">4</span><span style="color:#708a53;">]</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$hwnd_c</span><span>=</span><span style="color:#8080ff;">0</span>

<span style="color:#b2b2b2;">$hGui</span><span>=</span><span style="color:#3a7474;">makeGui</span><span>()</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$c_title</span><span>=</span><span style="color:#006200;">GUICtrlCreateLabel</span><span>(</span><span style="color:#939300;">&quot;Jump:0-9,   Delete: Ctrl+0-9,   Add Current: Shift+0-9&quot;</span><span>, </span><span style="color:#8080ff;">10</span><span>, </span><span style="color:#8080ff;">2</span><span>,</span><span style="color:#b2b2b2;">$app_width</span><span>-</span><span style="color:#8080ff;">12</span><span>,</span><span style="color:#8080ff;">12</span><span>)</span>
<span style="color:#006200;">GUICtrlSetColor</span><span> ( </span><span style="color:#b2b2b2;">$c_title</span><span>, </span><span style="color:#8080ff;">0xFFFFFF</span><span> )</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$c_title2</span><span>=</span><span style="color:#006200;">GUICtrlCreateLabel</span><span>(</span><span style="color:#939300;">&quot;LShift+RShift: Show App,  Escape/Backspace: Hide App,  Delete: Exit App&quot;</span><span>, </span><span style="color:#8080ff;">10</span><span>, </span><span style="color:#8080ff;">16</span><span>,</span><span style="color:#b2b2b2;">$app_width</span><span>-</span><span style="color:#8080ff;">12</span><span>,</span><span style="color:#8080ff;">12</span><span>)</span>
<span style="color:#006200;">GUICtrlSetColor</span><span> ( </span><span style="color:#b2b2b2;">$c_title2</span><span>, </span><span style="color:#8080ff;">0xFFFFFF</span><span> )</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$c_has</span><span>=</span><span style="color:#006200;">GUICtrlCreateLabel</span><span>(</span><span style="color:#939300;">&quot;&quot;</span><span>, </span><span style="color:#8080ff;">10</span><span>, </span><span style="color:#8080ff;">30</span><span>,</span><span style="color:#b2b2b2;">$app_width</span><span>-</span><span style="color:#8080ff;">12</span><span>,</span><span style="color:#8080ff;">12</span><span>)</span>
<span style="color:#006200;">GUICtrlSetColor</span><span> ( </span><span style="color:#b2b2b2;">$c_has</span><span>, </span><span style="color:#8080ff;">0x9999FF</span><span> )</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$start_y</span><span>=</span><span style="color:#8080ff;">52</span>

<span style="color:#3a7474;">makeButtons</span><span>()</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$k_esc</span><span> = </span><span style="color:#006200;">GUICtrlCreateDummy</span><span>()</span>
<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$k_del</span><span> = </span><span style="color:#006200;">GUICtrlCreateDummy</span><span>()</span>

<span style="color:#2b2bff;">Global</span><span> </span><span style="color:#b2b2b2;">$AK</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">33</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">2</span><span style="color:#708a53;">]</span><span>=</span><span style="color:#708a53;">[</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  </span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'1'</span><span>,</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'2'</span><span>,</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">1</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'3'</span><span>,</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">2</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'4'</span><span>,</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">3</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'5'</span><span>,</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">4</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'6'</span><span>,</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">5</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'7'</span><span>,</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">6</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'8'</span><span>,</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">7</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'9'</span><span>,</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">8</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'0'</span><span>,</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">9</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'^1'</span><span>,</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'^2'</span><span>,</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">1</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'^3'</span><span>,</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">2</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'^4'</span><span>,</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">3</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'^5'</span><span>,</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">4</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'^6'</span><span>,</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">5</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'^7'</span><span>,</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">6</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'^8'</span><span>,</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">7</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'^9'</span><span>,</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">8</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'^0'</span><span>,</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">9</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'+1'</span><span>,</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'+2'</span><span>,</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">1</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'+3'</span><span>,</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">2</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'+4'</span><span>,</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">3</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'+5'</span><span>,</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">4</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'+6'</span><span>,</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">5</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'+7'</span><span>,</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">6</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'+8'</span><span>,</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">7</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'+9'</span><span>,</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">8</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'+0'</span><span>,</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">9</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'{esc}'</span><span>,</span><span style="color:#b2b2b2;">$k_esc</span><span style="color:#708a53;">]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'{del}'</span><span>,</span><span style="color:#b2b2b2;">$k_del</span><span style="color:#708a53;">]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  ,</span><span style="color:#708a53;">[</span><span style="color:#7a7b62;">'{backspace}'</span><span>,</span><span style="color:#b2b2b2;">$k_esc</span><span style="color:#708a53;">]</span><span> </span><span style="color:#b2b2b2;">_</span>
<span>  </span><span style="color:#708a53;">]</span>
<span style="color:#006200;">GUISetAccelerators</span><span>(</span><span style="color:#b2b2b2;">$AK</span><span>)</span>

<span style="color:#006200;">GUISetBkColor</span><span> (</span><span style="color:#8080ff;">0x000000</span><span>, </span><span style="color:#b2b2b2;">$hGui</span><span> )</span>




<span style="color:#363250;">;HotKeySet ( &quot;#'&quot; , &quot;test1&quot; )</span>
<span style="color:#363250;">;HotKeySet ( &quot;#^'&quot; , &quot;test2&quot; )</span>

<span style="color:#363250;">;While 1</span>
<span style="color:#363250;">;    Sleep(100)</span>
<span style="color:#363250;">;WEnd</span>
<span style="color:#363250;">;</span>
<span style="color:#363250;">;Exit</span>



<span style="color:#3a7474;">AppAct</span><span>()</span>
<span style="color:#3a7474;">Main</span><span>()</span>

<span style="color:#363250;">;HotKeySet ( &quot;key&quot; [, &quot;function&quot;] )</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">test2</span><span>()</span>
<span style="color:#363250;">;MsgBox(0,'','')</span>
<span style="color:#006200;">Sleep</span><span>(</span><span style="color:#8080ff;">3000</span><span>)</span>
<span style="color:#3a7474;">AppAct</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>


<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">test1</span><span>()</span>
<span>  </span><span style="color:#363250;">;MsgBox(0,'','')</span>
<span>  </span><span style="color:#3a7474;">AppAct</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>



<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">Main</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$msg</span>
<span>  </span><span style="color:#2b2bff;">While</span><span> </span><span style="color:#8080ff;">1</span>
<span>    </span><span style="color:#b2b2b2;">$loopct</span><span>=</span><span style="color:#b2b2b2;">$loopct</span><span>+</span><span style="color:#8080ff;">1</span>
<span>    </span><span style="color:#363250;">;If Mod($loopct,100)==0 Then</span>
<span>    </span><span style="color:#363250;">;  ToolTip($loopct)</span>
<span>    </span><span style="color:#363250;">;EndIf</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$app_hidden</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>      </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#006200;">Mod</span><span>(</span><span style="color:#b2b2b2;">$loopct</span><span>,</span><span style="color:#8080ff;">100</span><span>)==</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>        </span><span style="color:#3a7474;">checkHwndCurrent</span><span>()</span>
<span>        </span><span style="color:#3a7474;">checkMaybeTip</span><span>()</span>
<span>      </span><span style="color:#2b2bff;">EndIf</span>
<span>      </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#006200;">Mod</span><span>(</span><span style="color:#b2b2b2;">$loopct</span><span>,</span><span style="color:#8080ff;">500</span><span>)==</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>        </span><span style="color:#3a7474;">refreshButtons</span><span>()</span>
<span>      </span><span style="color:#2b2bff;">EndIf</span>
<span>      </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#3a7474;">Key2OnlyCheck</span><span>(</span><span style="color:#b2b2b2;">$vk_trigger_l</span><span>,</span><span style="color:#b2b2b2;">$vk_trigger_r</span><span>,</span><span style="color:#b2b2b2;">$hDLL</span><span>) </span><span style="color:#2b2bff;">Then</span>
<span>        </span><span style="color:#3a7474;">AppAct</span><span>()</span>
<span>      </span><span style="color:#2b2bff;">EndIf</span>
<span>    </span><span style="color:#2b2bff;">Else</span>
<span>      </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#006200;">Mod</span><span>(</span><span style="color:#b2b2b2;">$loopct</span><span>,</span><span style="color:#8080ff;">50</span><span>)==</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>        </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#006200;">WinGetHandle</span><span>(</span><span style="color:#7a7b62;">'[active]'</span><span>)&lt;&gt;</span><span style="color:#b2b2b2;">$hGui</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>          </span><span style="color:#3a7474;">AppHide</span><span>()</span>
<span>        </span><span style="color:#2b2bff;">EndIf</span>
<span>      </span><span style="color:#2b2bff;">EndIf</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>    </span><span style="color:#b2b2b2;">$msg</span><span> = </span><span style="color:#006200;">GUIGetMsg</span><span>()</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$msg</span><span>==</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>      </span><span style="color:#2b2bff;">ContinueLoop</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#2b2bff;">False</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#2b2bff;">ElseIf</span><span> </span><span style="color:#3a7474;">checkHandleSpecial</span><span>(</span><span style="color:#b2b2b2;">$msg</span><span>) </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#2b2bff;">ElseIf</span><span> </span><span style="color:#3a7474;">checkHandleButton</span><span>(</span><span style="color:#b2b2b2;">$msg</span><span>) </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#2b2bff;">ElseIf</span><span> </span><span style="color:#3a7474;">checkHandleLabel</span><span>(</span><span style="color:#b2b2b2;">$msg</span><span>) </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#2b2bff;">ElseIf</span><span> </span><span style="color:#3a7474;">checkHandleLabel2</span><span>(</span><span style="color:#b2b2b2;">$msg</span><span>) </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">WEnd</span>
<span>  </span><span style="color:#3a7474;">Terminate</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>


<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">evtHwndCurrentChg</span><span>()</span>
<span>  </span><span style="color:#b2b2b2;">$hwnd_c_t</span><span>=</span><span style="color:#006200;">TimerInit</span><span>()</span>
<span>  </span><span style="color:#b2b2b2;">$hwnd_c_tu</span><span>=</span><span style="color:#8080ff;">0</span><span style="color:#363250;">;</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#363250;">; tip windows</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">checkMaybeTip</span><span>()</span>
<span>  </span><span style="color:#3a7474;">checkMaybeUntipWin</span><span>()</span>
<span>  </span><span style="color:#3a7474;">checkMaybeTipWin</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">checkMaybeUntipWin</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$hwnd_c_tu</span><span>==</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#ff00ff;">Return</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#006200;">TimerDiff</span><span>(</span><span style="color:#b2b2b2;">$hwnd_c_tu</span><span>)&gt;</span><span style="color:#8080ff;">4000</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#006200;">ToolTip</span><span>(</span><span style="color:#7a7b62;">''</span><span>)</span>
<span>    </span><span style="color:#b2b2b2;">$hwnd_c_tu</span><span>=</span><span style="color:#8080ff;">0</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">checkMaybeTipWin</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$hwnd_c_t</span><span>==</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#ff00ff;">Return</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#006200;">TimerDiff</span><span>(</span><span style="color:#b2b2b2;">$hwnd_c_t</span><span>)&gt;</span><span style="color:#8080ff;">2000</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#3a7474;">maybeTipWin</span><span>()</span>
<span>    </span><span style="color:#b2b2b2;">$hwnd_c_t</span><span>=</span><span style="color:#8080ff;">0</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">maybeTipWin</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$x</span><span>,</span><span style="color:#b2b2b2;">$end</span><span>=</span><span style="color:#8080ff;">9</span>
<span>  </span><span style="color:#ff00ff;">For</span><span> </span><span style="color:#b2b2b2;">$x</span><span>=</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">To</span><span> </span><span style="color:#b2b2b2;">$end</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$hwnds</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$x</span><span style="color:#708a53;">]</span><span>==</span><span style="color:#b2b2b2;">$hwnd_c</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>      </span><span style="color:#3a7474;">tipWinKey</span><span>(</span><span style="color:#b2b2b2;">$x</span><span>)</span>
<span>      </span><span style="color:#ff00ff;">Return</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">Next</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">tipWinKey</span><span>(</span><span style="color:#b2b2b2;">$x</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$p</span><span>=</span><span style="color:#006200;">WinGetPos</span><span>(</span><span style="color:#b2b2b2;">$hwnd_c</span><span>)</span>
<span>  </span><span style="color:#363250;">;ToolTip ( &quot;text&quot; [, x [, y [, &quot;title&quot; [, icon [, options]]]]] )</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$xx</span><span>=</span><span style="color:#b2b2b2;">$x</span><span>+</span><span style="color:#8080ff;">1</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$xx</span><span>=</span><span style="color:#8080ff;">10</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#b2b2b2;">$xx</span><span>=</span><span style="color:#8080ff;">0</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#006200;">ToolTip</span><span>(</span><span style="color:#b2b2b2;">$xx</span><span>,</span><span style="color:#b2b2b2;">$p</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span>+</span><span style="color:#8080ff;">10</span><span>,</span><span style="color:#b2b2b2;">$p</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">1</span><span style="color:#708a53;">]</span><span>+</span><span style="color:#8080ff;">10</span><span>,</span><span style="color:#7a7b62;">'LR Shift'</span><span>,</span><span style="color:#8080ff;">1</span><span>,</span><span style="color:#8080ff;">4</span><span>)</span>
<span>  </span><span style="color:#b2b2b2;">$hwnd_c_tu</span><span>=</span><span style="color:#006200;">TimerInit</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">assignHwndCurrent</span><span>(</span><span style="color:#b2b2b2;">$h</span><span>)</span>
<span>  </span><span style="color:#b2b2b2;">$hwnd_c</span><span>=</span><span style="color:#b2b2b2;">$h</span>
<span>  </span><span style="color:#3a7474;">evtHwndCurrentChg</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#363250;">; main handlers</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">checkHwndCurrent</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$hc</span><span>=</span><span style="color:#006200;">WinGetHandle</span><span>(</span><span style="color:#7a7b62;">'[active]'</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$hwnd_c</span><span>==</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#3a7474;">assignHwndCurrent</span><span>(</span><span style="color:#b2b2b2;">$hc</span><span>)</span>
<span>    </span><span style="color:#ff00ff;">Return</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#ff00ff;">Not</span><span> </span><span style="color:#006200;">IsHWnd</span><span>(</span><span style="color:#b2b2b2;">$hwnd_c</span><span>) </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#3a7474;">assignHwndCurrent</span><span>(</span><span style="color:#b2b2b2;">$hc</span><span>)</span>
<span>    </span><span style="color:#3a7474;">evtHwndCurrentChg</span><span>()</span>
<span>    </span><span style="color:#ff00ff;">Return</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$hc</span><span>&lt;&gt;</span><span style="color:#b2b2b2;">$hGui</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$hc</span><span>&lt;&gt;</span><span style="color:#b2b2b2;">$hwnd_c</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>      </span><span style="color:#3a7474;">assignHwndCurrent</span><span>(</span><span style="color:#b2b2b2;">$hc</span><span>)</span>
<span>      </span><span style="color:#3a7474;">evtHwndCurrentChg</span><span>()</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">checkHandleSpecial</span><span>(</span><span style="color:#b2b2b2;">$msg</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#2b2bff;">False</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>  </span><span style="color:#2b2bff;">ElseIf</span><span> </span><span style="color:#b2b2b2;">$msg</span><span>==</span><span style="color:#b2b2b2;">$k_del</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#3a7474;">Terminate</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">ElseIf</span><span> </span><span style="color:#b2b2b2;">$msg</span><span>==</span><span style="color:#b2b2b2;">$k_esc</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#3a7474;">AppHide</span><span>()</span>
<span>    </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#2b2bff;">True</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#2b2bff;">False</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">checkHandleButton</span><span>(</span><span style="color:#b2b2b2;">$msg</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$x</span><span>,</span><span style="color:#b2b2b2;">$end</span><span>=</span><span style="color:#8080ff;">9</span>
<span>  </span><span style="color:#ff00ff;">For</span><span> </span><span style="color:#b2b2b2;">$x</span><span>=</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">To</span><span> </span><span style="color:#b2b2b2;">$end</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$msg</span><span>==</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$x</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>      </span><span style="color:#3a7474;">handleButton</span><span>(</span><span style="color:#b2b2b2;">$x</span><span>)</span>
<span>      </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#2b2bff;">True</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">Next</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#2b2bff;">False</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">checkHandleLabel</span><span>(</span><span style="color:#b2b2b2;">$msg</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$x</span><span>,</span><span style="color:#b2b2b2;">$end</span><span>=</span><span style="color:#8080ff;">9</span>
<span>  </span><span style="color:#ff00ff;">For</span><span> </span><span style="color:#b2b2b2;">$x</span><span>=</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">To</span><span> </span><span style="color:#b2b2b2;">$end</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$msg</span><span>==</span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$x</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>      </span><span style="color:#363250;">;Msg('handleLabel:x:'&amp;$x)</span>
<span>      </span><span style="color:#3a7474;">handleLabel</span><span>(</span><span style="color:#b2b2b2;">$x</span><span>)</span>
<span>      </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#2b2bff;">True</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">Next</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#2b2bff;">False</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">checkHandleLabel2</span><span>(</span><span style="color:#b2b2b2;">$msg</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$x</span><span>,</span><span style="color:#b2b2b2;">$end</span><span>=</span><span style="color:#8080ff;">9</span>
<span>  </span><span style="color:#ff00ff;">For</span><span> </span><span style="color:#b2b2b2;">$x</span><span>=</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">To</span><span> </span><span style="color:#b2b2b2;">$end</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$msg</span><span>==</span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$x</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>      </span><span style="color:#3a7474;">handleLabel2</span><span>(</span><span style="color:#b2b2b2;">$x</span><span>)</span>
<span>      </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#2b2bff;">True</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">Next</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#2b2bff;">False</span>
<span style="color:#2b2bff;">EndFunc</span>



<span style="color:#363250;">; form</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">makeGui</span><span>()</span>
<span>  </span><span style="color:#363250;">;GUICreate ( &quot;title&quot; [, width [, height [, left [, top [, style [, exStyle [, parent]]]]]]] )</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$h</span><span>=</span><span style="color:#006200;">GUICreate</span><span> (</span><span style="color:#b2b2b2;">$app_title</span><span>,</span><span style="color:#b2b2b2;">$app_width</span><span>,</span><span style="color:#b2b2b2;">$app_height</span><span>,</span><span style="color:#b2b2b2;">$app_x</span><span>,</span><span style="color:#b2b2b2;">$app_y</span><span>,</span><span style="color:#b2b2b2;">$app_style</span><span>,</span><span style="color:#b2b2b2;">$app_ex_style</span><span>,</span><span style="color:#b2b2b2;">$app_parent</span><span>)</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#b2b2b2;">$h</span><span style="color:#363250;">;</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">makeButtons</span><span>()</span>
<span>  </span><span style="color:#3a7474;">makeButtonsV</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">makeButtonsV</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$x</span><span>=</span><span style="color:#8080ff;">20</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$cy</span><span>=</span><span style="color:#b2b2b2;">$start_y</span>
<span>  </span><span style="color:#ff00ff;">For</span><span> </span><span style="color:#b2b2b2;">$i</span><span>=</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">To</span><span> </span><span style="color:#006200;">UBound</span><span>(</span><span style="color:#b2b2b2;">$btns</span><span>)-</span><span style="color:#8080ff;">1</span>
<span>    </span><span style="color:#3a7474;">makeButtonV</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>,</span><span style="color:#b2b2b2;">$x</span><span>,</span><span style="color:#b2b2b2;">$cy</span><span>)</span>
<span>    </span><span style="color:#b2b2b2;">$cy</span><span>+=</span><span style="color:#b2b2b2;">$btn_h</span>
<span>  </span><span style="color:#2b2bff;">Next</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">makeButtonV</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>,</span><span style="color:#b2b2b2;">$x</span><span>,</span><span style="color:#b2b2b2;">$y</span><span>)</span>
<span>    </span><span style="color:#b2b2b2;">local</span><span> </span><span style="color:#b2b2b2;">$h_b</span><span>=</span><span style="color:#006200;">GUICtrlCreateButton</span><span>(</span><span style="color:#939300;">&quot;&quot;</span><span>, </span><span style="color:#b2b2b2;">$x</span><span>, </span><span style="color:#b2b2b2;">$y</span><span>, </span><span style="color:#b2b2b2;">$btn_w</span><span>, </span><span style="color:#b2b2b2;">$btn_h</span><span>, </span><span style="color:#634880;">$BS_ICON</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$tt</span><span>=</span><span style="color:#939300;">&quot;&quot;</span><span style="color:#ff00ff;">&amp;</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>+</span><span style="color:#8080ff;">1</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$i</span><span>==</span><span style="color:#8080ff;">9</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>      </span><span style="color:#b2b2b2;">$tt</span><span>=</span><span style="color:#7a7b62;">'0'</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>    </span><span style="color:#b2b2b2;">local</span><span> </span><span style="color:#b2b2b2;">$h_l</span><span>=</span><span style="color:#006200;">GUICtrlCreateLabel</span><span>(</span><span style="color:#b2b2b2;">$tt</span><span>, </span><span style="color:#8080ff;">5</span><span>, </span><span style="color:#b2b2b2;">$y</span><span>+(</span><span style="color:#b2b2b2;">$btn_h</span><span>/</span><span style="color:#8080ff;">2</span><span>)-</span><span style="color:#8080ff;">6</span><span>)</span>
<span>    </span><span style="color:#b2b2b2;">local</span><span> </span><span style="color:#b2b2b2;">$h_l2</span><span>=</span><span style="color:#006200;">GUICtrlCreateLabel</span><span>(</span><span style="color:#939300;">&quot;&quot;</span><span>, </span><span style="color:#b2b2b2;">$x</span><span>+</span><span style="color:#b2b2b2;">$btn_w</span><span>+</span><span style="color:#8080ff;">2</span><span>, </span><span style="color:#b2b2b2;">$y</span><span>+(</span><span style="color:#b2b2b2;">$btn_h</span><span>/</span><span style="color:#8080ff;">2</span><span>)-</span><span style="color:#8080ff;">6</span><span>,</span><span style="color:#b2b2b2;">$app_width</span><span>-</span><span style="color:#8080ff;">42</span><span>,</span><span style="color:#8080ff;">12</span><span>)</span>
<span>    </span><span style="color:#b2b2b2;">$lbl2</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span>=</span><span style="color:#b2b2b2;">$h_l2</span>
<span>    </span><span style="color:#b2b2b2;">$lbls</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span>=</span><span style="color:#b2b2b2;">$h_l</span>
<span>    </span><span style="color:#006200;">GUICtrlSetColor</span><span> ( </span><span style="color:#b2b2b2;">$h_l</span><span>, </span><span style="color:#8080ff;">0x999999</span><span> )</span>
<span>    </span><span style="color:#006200;">GUICtrlSetColor</span><span> ( </span><span style="color:#b2b2b2;">$h_l2</span><span>, </span><span style="color:#8080ff;">0x999999</span><span> )</span>
<span>    </span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span>=</span><span style="color:#b2b2b2;">$h_b</span>
<span>    </span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">1</span><span style="color:#708a53;">]</span><span>=</span><span style="color:#b2b2b2;">$h_l2</span>
<span style="color:#2b2bff;">EndFunc</span>
<span style="color:#363250;">;form commands</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">SetHas</span><span>(</span><span style="color:#634880;">$s</span><span>)</span>
<span>  </span><span style="color:#006200;">GUICtrlSetData</span><span>(</span><span style="color:#b2b2b2;">$c_has</span><span>,</span><span style="color:#7a7b62;">'Current Window: '</span><span style="color:#ff00ff;">&amp;</span><span style="color:#634880;">$s</span><span>)</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">Terminate</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">Exit</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">AppHide</span><span>()</span>
<span>  </span><span style="color:#b2b2b2;">$app_hidden</span><span>=</span><span style="color:#8080ff;">1</span>
<span>  </span><span style="color:#363250;">;$setting=False</span>
<span>  </span><span style="color:#3a7474;">SetHas</span><span>(</span><span style="color:#7a7b62;">''</span><span>)</span>
<span>  </span><span style="color:#3a7474;">_CrawlGUIOut</span><span>()</span>
<span>  </span><span style="color:#3a7474;">refreshButtons</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">AppAct</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$app_hidden</span><span>==</span><span style="color:#8080ff;">1</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#b2b2b2;">$app_hidden</span><span>=</span><span style="color:#8080ff;">0</span>
<span>    </span><span style="color:#b2b2b2;">$set_h</span><span>=</span><span style="color:#006200;">WinGetHandle</span><span>(</span><span style="color:#7a7b62;">'[active]'</span><span>)</span>
<span>    </span><span style="color:#3a7474;">SetHas</span><span>(</span><span style="color:#006200;">WinGetTitle</span><span>(</span><span style="color:#b2b2b2;">$set_h</span><span>))</span>
<span>    </span><span style="color:#006200;">WinActivate</span><span>(</span><span style="color:#b2b2b2;">$hGui</span><span>)</span>
<span>    </span><span style="color:#3a7474;">_CrawlGUIIn</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">Else</span>
<span>    </span><span style="color:#006200;">GUISetState</span><span>(@</span><span style="color:#b2b2b2;">SW_SHOW</span><span>)</span>
<span>    </span><span style="color:#006200;">WinActivate</span><span>(</span><span style="color:#b2b2b2;">$hGui</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#363250;">;form events</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">handleLabel</span><span>(</span><span style="color:#b2b2b2;">$I</span><span>)</span>
<span>  </span><span style="color:#3a7474;">DelItem</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>)</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">handleLabel2</span><span>(</span><span style="color:#b2b2b2;">$I</span><span>)</span>
<span>  </span><span style="color:#3a7474;">SetItem</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>)</span>
<span>  </span><span style="color:#3a7474;">AppHide</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">handleButton</span><span>(</span><span style="color:#b2b2b2;">$I</span><span>)</span>
<span>  </span><span style="color:#363250;">;Msg('Act :'&amp;$I)</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#ff00ff;">Not</span><span> </span><span style="color:#006200;">IsHWnd</span><span>(</span><span style="color:#b2b2b2;">$hwnds</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">]</span><span>) </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#3a7474;">SetItem</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Else</span>
<span>    </span><span style="color:#3a7474;">AppHide</span><span>()</span>
<span>    </span><span style="color:#3a7474;">ActItem</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span style="color:#2b2bff;">EndFunc</span>


<span style="color:#363250;">; items</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">DelItem</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>)</span>
<span>  </span><span style="color:#b2b2b2;">$hwnds</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">]</span><span>=</span><span style="color:#8080ff;">0</span>
<span>  </span><span style="color:#3a7474;">refreshButtons</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">SetItem</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>)</span>
<span>  </span><span style="color:#b2b2b2;">$hwnds</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">]</span><span>=</span><span style="color:#b2b2b2;">$set_h</span>
<span>  </span><span style="color:#3a7474;">refreshButtons</span><span>()</span>
<span style="color:#2b2bff;">EndFunc</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">ActItem</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$h</span><span>=</span><span style="color:#8080ff;">0</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$hwnds</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">]</span><span>&lt;&gt;</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#b2b2b2;">$h</span><span>=</span><span style="color:#006200;">WinActivate</span><span>(</span><span style="color:#b2b2b2;">$hwnds</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">]</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#b2b2b2;">$h</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#363250;">; buttons</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">refreshButtons</span><span>()</span>
<span>  </span><span style="color:#3a7474;">_GetProcessCollection</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$x</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$end</span><span>=</span><span style="color:#8080ff;">9</span>
<span>  </span><span style="color:#ff00ff;">For</span><span> </span><span style="color:#b2b2b2;">$x</span><span>=</span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">To</span><span> </span><span style="color:#b2b2b2;">$end</span>
<span>    </span><span style="color:#3a7474;">updateButton</span><span>(</span><span style="color:#b2b2b2;">$x</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Next</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">updateButton</span><span>(</span><span style="color:#b2b2b2;">$i</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$h</span><span>=</span><span style="color:#b2b2b2;">$hwnds</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">]</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#ff00ff;">Not</span><span> </span><span style="color:#006200;">IsHWnd</span><span>(</span><span style="color:#b2b2b2;">$h</span><span>) </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#b2b2b2;">$hwnds</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">]</span><span>=</span><span style="color:#8080ff;">0</span>
<span>    </span><span style="color:#3a7474;">GUICtrlDeleteImage</span><span>(</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span>)</span>
<span>    </span><span style="color:#006200;">GUICtrlSetData</span><span>(</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">1</span><span style="color:#708a53;">]</span><span>,</span><span style="color:#7a7b62;">''</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Else</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$fp</span><span>=</span><span style="color:#3a7474;">_Win2ProcessLocation</span><span>(</span><span style="color:#b2b2b2;">$h</span><span>)</span>
<span>    </span><span style="color:#006200;">GUICtrlSetImage</span><span>(</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span>, </span><span style="color:#b2b2b2;">$fp</span><span>,</span><span style="color:#8080ff;">1</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$tw</span><span>=</span><span style="color:#006200;">WinGetTitle</span><span>(</span><span style="color:#b2b2b2;">$h</span><span>)</span>
<span>    </span><span style="color:#006200;">GUICtrlSetData</span><span>(</span><span style="color:#b2b2b2;">$btns</span><span style="color:#708a53;">[</span><span style="color:#b2b2b2;">$i</span><span style="color:#708a53;">][</span><span style="color:#8080ff;">1</span><span style="color:#708a53;">]</span><span>, </span><span style="color:#b2b2b2;">$tw</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#363250;">;gui animation</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">_CrawlGUIIn</span><span>()</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$hWnd</span><span>=</span><span style="color:#b2b2b2;">$hGui</span>
<span>    </span><span style="color:#b2b2b2;">$iMax</span><span>=</span><span style="color:#b2b2b2;">$GUIFADE_MAXTRANS</span>
<span>    </span><span style="color:#363250;">;$GUIFADE_MAXTRANS = $iMax</span>
<span>    </span><span style="color:#006200;">WinSetTrans</span><span>(</span><span style="color:#b2b2b2;">$hWnd</span><span>, </span><span style="color:#939300;">&quot;&quot;</span><span>, </span><span style="color:#8080ff;">0</span><span>)</span>
<span>    </span><span style="color:#006200;">GUISetState</span><span>(@</span><span style="color:#b2b2b2;">SW_SHOW</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$p</span><span>=</span><span style="color:#006200;">WinGetPos</span><span>(</span><span style="color:#b2b2b2;">$hWnd</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$xx</span><span>=</span><span style="color:#b2b2b2;">$p</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$yy</span><span>=</span><span style="color:#b2b2b2;">$p</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">1</span><span style="color:#708a53;">]</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$ww</span><span>=</span><span style="color:#b2b2b2;">$p</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">2</span><span style="color:#708a53;">]</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$hh</span><span>=</span><span style="color:#b2b2b2;">$p</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">3</span><span style="color:#708a53;">]</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$yp</span><span>=(</span><span style="color:#b2b2b2;">$app_home_y</span><span>-</span><span style="color:#b2b2b2;">$yy</span><span>)/(</span><span style="color:#b2b2b2;">$iMax</span><span>/</span><span style="color:#b2b2b2;">$in_step</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$delay</span><span> = </span><span style="color:#8080ff;">1</span>
<span>    </span><span style="color:#ff00ff;">For</span><span> </span><span style="color:#b2b2b2;">$i</span><span> = </span><span style="color:#8080ff;">1</span><span> </span><span style="color:#2b2bff;">To</span><span> </span><span style="color:#b2b2b2;">$iMax</span><span> </span><span style="color:#2b2bff;">Step</span><span> </span><span style="color:#b2b2b2;">$in_step</span>
<span>        </span><span style="color:#006200;">WinSetTrans</span><span>(</span><span style="color:#b2b2b2;">$hWnd</span><span>, </span><span style="color:#939300;">&quot;&quot;</span><span>, </span><span style="color:#b2b2b2;">$i</span><span>)</span>
<span>        </span><span style="color:#b2b2b2;">$yy</span><span>=</span><span style="color:#b2b2b2;">$yy</span><span>+</span><span style="color:#b2b2b2;">$yp</span>
<span>        </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$yy</span><span>&gt;</span><span style="color:#b2b2b2;">$app_home_y</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>          </span><span style="color:#b2b2b2;">$yy</span><span>=</span><span style="color:#b2b2b2;">$app_home_y</span>
<span>        </span><span style="color:#2b2bff;">EndIf</span>
<span>        </span><span style="color:#363250;">;ToolTip('yy:'&amp;$yy)</span>
<span>        </span><span style="color:#006200;">WinMove</span><span>(</span><span style="color:#b2b2b2;">$hWnd</span><span>, </span><span style="color:#939300;">&quot;&quot;</span><span>, </span><span style="color:#b2b2b2;">$xx</span><span>, </span><span style="color:#006200;">Int</span><span>(</span><span style="color:#b2b2b2;">$yy</span><span>))</span>
<span>        </span><span style="color:#006200;">Sleep</span><span>(</span><span style="color:#b2b2b2;">$delay</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">Next</span>
<span>    </span><span style="color:#006200;">WinMove</span><span>(</span><span style="color:#b2b2b2;">$hWnd</span><span>, </span><span style="color:#939300;">&quot;&quot;</span><span>, </span><span style="color:#b2b2b2;">$xx</span><span>, </span><span style="color:#b2b2b2;">$app_home_y</span><span>)</span>
<span style="color:#2b2bff;">EndFunc</span><span>   </span><span style="color:#363250;">;==&gt;_FadeGUIIn</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">_CrawlGUIOut</span><span>()</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$hWnd</span><span>=</span><span style="color:#b2b2b2;">$hGui</span>
<span>    </span><span style="color:#b2b2b2;">$iMax</span><span>=</span><span style="color:#8080ff;">255</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$delay</span><span> = </span><span style="color:#8080ff;">1</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$p</span><span>=</span><span style="color:#006200;">WinGetPos</span><span>(</span><span style="color:#b2b2b2;">$hWnd</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$xx</span><span>=</span><span style="color:#b2b2b2;">$p</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$yy</span><span>=</span><span style="color:#b2b2b2;">$p</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">1</span><span style="color:#708a53;">]</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$ww</span><span>=</span><span style="color:#b2b2b2;">$p</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">2</span><span style="color:#708a53;">]</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$hh</span><span>=</span><span style="color:#b2b2b2;">$p</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">3</span><span style="color:#708a53;">]</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$yp</span><span>=(</span><span style="color:#b2b2b2;">$yy</span><span>-</span><span style="color:#b2b2b2;">$app_x</span><span>)/(</span><span style="color:#b2b2b2;">$iMax</span><span>/</span><span style="color:#b2b2b2;">$out_step</span><span>)</span>
<span>    </span><span style="color:#ff00ff;">For</span><span> </span><span style="color:#b2b2b2;">$i</span><span> = </span><span style="color:#b2b2b2;">$GUIFADE_MAXTRANS</span><span> </span><span style="color:#2b2bff;">To</span><span> </span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Step</span><span> -</span><span style="color:#b2b2b2;">$out_step</span>
<span>        </span><span style="color:#006200;">WinSetTrans</span><span>(</span><span style="color:#b2b2b2;">$hWnd</span><span>, </span><span style="color:#939300;">&quot;&quot;</span><span>, </span><span style="color:#b2b2b2;">$i</span><span>)</span>
<span>        </span><span style="color:#b2b2b2;">$yy</span><span>=</span><span style="color:#b2b2b2;">$yy</span><span>-</span><span style="color:#b2b2b2;">$yp</span>
<span>        </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$yy</span><span>&lt;</span><span style="color:#b2b2b2;">$app_y</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>          </span><span style="color:#b2b2b2;">$yy</span><span>=</span><span style="color:#b2b2b2;">$app_y</span>
<span>        </span><span style="color:#2b2bff;">EndIf</span>
<span>        </span><span style="color:#006200;">WinMove</span><span>(</span><span style="color:#b2b2b2;">$hWnd</span><span>, </span><span style="color:#939300;">&quot;&quot;</span><span>, </span><span style="color:#b2b2b2;">$xx</span><span>, </span><span style="color:#006200;">Int</span><span>(</span><span style="color:#b2b2b2;">$yy</span><span>))</span>
<span>        </span><span style="color:#006200;">Sleep</span><span>(</span><span style="color:#b2b2b2;">$delay</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">Next</span>
<span>    </span><span style="color:#006200;">GUISetState</span><span>(@</span><span style="color:#b2b2b2;">SW_HIDE</span><span>)</span>
<span>    </span><span style="color:#006200;">WinMove</span><span>(</span><span style="color:#b2b2b2;">$hWnd</span><span>, </span><span style="color:#939300;">&quot;&quot;</span><span>, </span><span style="color:#b2b2b2;">$xx</span><span>, </span><span style="color:#b2b2b2;">$app_y</span><span>)</span>
<span style="color:#2b2bff;">EndFunc</span>


<span style="color:#363250;">;key state</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">Key2OnlyCheck</span><span>(</span><span style="color:#b2b2b2;">$iHexKey1</span><span>,</span><span style="color:#b2b2b2;">$iHexKey2</span><span>, </span><span style="color:#b2b2b2;">$vDLL</span><span> = </span><span style="color:#7a7b62;">'user32.dll'</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$ikey</span><span>, </span><span style="color:#b2b2b2;">$ia_R</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$iStart</span><span>=</span><span style="color:#8080ff;">0</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$iFinish</span><span>=</span><span style="color:#8080ff;">255</span>
<span>  </span><span style="color:#ff00ff;">For</span><span> </span><span style="color:#b2b2b2;">$ikey</span><span> = </span><span style="color:#b2b2b2;">$iStart</span><span> </span><span style="color:#2b2bff;">To</span><span> </span><span style="color:#b2b2b2;">$iFinish</span>
<span>    </span><span style="color:#b2b2b2;">$ia_R</span><span> = </span><span style="color:#006200;">DllCall</span><span>(</span><span style="color:#b2b2b2;">$vDLL</span><span>, </span><span style="color:#7a7b62;">'int'</span><span>, </span><span style="color:#7a7b62;">'GetAsyncKeyState'</span><span>, </span><span style="color:#7a7b62;">'int'</span><span>, </span><span style="color:#7a7b62;">'0x'</span><span> </span><span style="color:#ff00ff;">&amp;</span><span> </span><span style="color:#006200;">Hex</span><span>(</span><span style="color:#b2b2b2;">$ikey</span><span>, </span><span style="color:#8080ff;">2</span><span>))</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#ff00ff;">Not</span><span> </span><span style="color:#3a7474;">Like2</span><span>(</span><span style="color:#b2b2b2;">$ikey</span><span>,</span><span style="color:#b2b2b2;">$iHexKey1</span><span>,</span><span style="color:#b2b2b2;">$iHexKey2</span><span>) </span><span style="color:#2b2bff;">Then</span>
<span>      </span><span style="color:#2b2bff;">If</span><span> @</span><span style="color:#b2b2b2;">error</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>        </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">0</span>
<span>      </span><span style="color:#2b2bff;">Else</span>
<span>        </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#006200;">BitAND</span><span>(</span><span style="color:#b2b2b2;">$ia_R</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span>, </span><span style="color:#8080ff;">0x8000</span><span>) = </span><span style="color:#8080ff;">0x8000</span><span> </span><span style="color:#2b2bff;">Then</span><span> </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">0</span>
<span>      </span><span style="color:#2b2bff;">EndIf</span>
<span>    </span><span style="color:#2b2bff;">Else</span>
<span>      </span><span style="color:#2b2bff;">If</span><span> @</span><span style="color:#b2b2b2;">error</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>        </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">0</span>
<span>      </span><span style="color:#2b2bff;">Else</span>
<span>        </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#ff00ff;">Not</span><span> </span><span style="color:#006200;">BitAND</span><span>(</span><span style="color:#b2b2b2;">$ia_R</span><span style="color:#708a53;">[</span><span style="color:#8080ff;">0</span><span style="color:#708a53;">]</span><span>, </span><span style="color:#8080ff;">0x8000</span><span>) = </span><span style="color:#8080ff;">0x8000</span><span> </span><span style="color:#2b2bff;">Then</span><span> </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">0</span>
<span>      </span><span style="color:#2b2bff;">EndIf</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#2b2bff;">Next</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">1</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">Like</span><span>(</span><span style="color:#b2b2b2;">$iTgtVk</span><span>,</span><span style="color:#b2b2b2;">$iSrcVk</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$iSrcVk</span><span>==</span><span style="color:#8080ff;">0xA0</span><span> </span><span style="color:#b2b2b2;">and</span><span> </span><span style="color:#b2b2b2;">$iTgtVk</span><span>==</span><span style="color:#8080ff;">0x10</span><span> </span><span style="color:#2b2bff;">Then</span><span> </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">1</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$iSrcVk</span><span>==</span><span style="color:#8080ff;">0xA1</span><span> </span><span style="color:#b2b2b2;">and</span><span> </span><span style="color:#b2b2b2;">$iTgtVk</span><span>==</span><span style="color:#8080ff;">0x10</span><span> </span><span style="color:#2b2bff;">Then</span><span> </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">1</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$iSrcVk</span><span>==</span><span style="color:#8080ff;">0xA2</span><span> </span><span style="color:#b2b2b2;">and</span><span> </span><span style="color:#b2b2b2;">$iTgtVk</span><span>==</span><span style="color:#8080ff;">0x11</span><span> </span><span style="color:#2b2bff;">Then</span><span> </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">1</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$iSrcVk</span><span>==</span><span style="color:#8080ff;">0xA3</span><span> </span><span style="color:#b2b2b2;">and</span><span> </span><span style="color:#b2b2b2;">$iTgtVk</span><span>==</span><span style="color:#8080ff;">0x11</span><span> </span><span style="color:#2b2bff;">Then</span><span> </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">1</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$iSrcVk</span><span>==</span><span style="color:#8080ff;">0xA4</span><span> </span><span style="color:#b2b2b2;">and</span><span> </span><span style="color:#b2b2b2;">$iTgtVk</span><span>==</span><span style="color:#8080ff;">0x12</span><span> </span><span style="color:#2b2bff;">Then</span><span> </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">1</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$iSrcVk</span><span>==</span><span style="color:#8080ff;">0xA5</span><span> </span><span style="color:#b2b2b2;">and</span><span> </span><span style="color:#b2b2b2;">$iTgtVk</span><span>==</span><span style="color:#8080ff;">0x12</span><span> </span><span style="color:#2b2bff;">Then</span><span> </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">1</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$iSrcVk</span><span>==</span><span style="color:#b2b2b2;">$iTgtVk</span><span> </span><span style="color:#2b2bff;">Then</span><span> </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">1</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#8080ff;">0</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">Like2</span><span>(</span><span style="color:#b2b2b2;">$iTgtVk</span><span>,</span><span style="color:#b2b2b2;">$iSrcVk1</span><span>,</span><span style="color:#b2b2b2;">$iSrcVk2</span><span>)</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> (</span><span style="color:#3a7474;">Like</span><span>(</span><span style="color:#b2b2b2;">$iTgtVk</span><span>,</span><span style="color:#b2b2b2;">$iSrcVk1</span><span>)+</span><span style="color:#3a7474;">Like</span><span>(</span><span style="color:#b2b2b2;">$iTgtVk</span><span>,</span><span style="color:#b2b2b2;">$iSrcVk2</span><span>))&gt;</span><span style="color:#8080ff;">0</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#363250;">; process path</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">_Win2ProcessLocation</span><span>(</span><span style="color:#b2b2b2;">$wintitle</span><span>)</span>
<span>  </span><span style="color:#363250;">;Global $oColItems</span>
<span>    </span><span style="color:#363250;">;if isstring($wintitle) = 0 then return -1</span>
<span>    </span><span style="color:#b2b2b2;">$wproc</span><span> = </span><span style="color:#006200;">WinGetProcess</span><span>(</span><span style="color:#b2b2b2;">$wintitle</span><span>)</span>
<span>    </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#3a7474;">_ProcessIdPath</span><span>(</span><span style="color:#b2b2b2;">$wproc</span><span>)</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">_ProcessIdPath</span><span> ( </span><span style="color:#b2b2b2;">$vPID</span><span> )</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$sNoExePath</span><span> = </span><span style="color:#7a7b62;">''</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$RetErr_ProcessDoesntExist</span><span> = </span><span style="color:#8080ff;">1</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$RetErr_ProcessPathUnknown</span><span> = </span><span style="color:#8080ff;">2</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$RetErr_ProcessNotFound</span><span> = </span><span style="color:#8080ff;">3</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$RetErr_ObjCreateErr</span><span> = </span><span style="color:#8080ff;">4</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$RetErr_UnknownErr</span><span> = </span><span style="color:#8080ff;">5</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#ff00ff;">Not</span><span> </span><span style="color:#006200;">ProcessExists</span><span> ( </span><span style="color:#b2b2b2;">$vPID</span><span> )  </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#006200;">SetError</span><span> ( </span><span style="color:#b2b2b2;">$RetErr_ProcessDoesntExist</span><span> )</span>
<span>    </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#b2b2b2;">$sNoExePath</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span>  </span><span style="color:#3a7474;">_GetProcessCollection</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#006200;">IsObj</span><span> ( </span><span style="color:#b2b2b2;">$oColItems</span><span> )  </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#ff00ff;">For</span><span> </span><span style="color:#b2b2b2;">$objItem</span><span> </span><span style="color:#2b2bff;">In</span><span> </span><span style="color:#b2b2b2;">$oColItems</span>
<span>      </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$vPID</span><span> = </span><span style="color:#b2b2b2;">$objItem</span><span>.</span><span style="color:#b2b2b2;">ProcessId</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>        </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$objItem</span><span>.</span><span style="color:#b2b2b2;">ExecutablePath</span><span> = </span><span style="color:#7a7b62;">'0'</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>          </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#006200;">FileExists</span><span> ( </span><span style="color:#ff00ff;">@SystemDir</span><span> </span><span style="color:#ff00ff;">&amp;</span><span> </span><span style="color:#7a7b62;">'\' &amp; $objItem.Caption )  Then</span>
<span>            </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#ff00ff;">@SystemDir</span><span> </span><span style="color:#ff00ff;">&amp;</span><span> </span><span style="color:#7a7b62;">'\' &amp; $objItem.Caption</span>
<span>          </span><span style="color:#2b2bff;">Else</span>
<span>            </span><span style="color:#006200;">SetError</span><span> ( </span><span style="color:#b2b2b2;">$RetErr_ProcessPathUnknown</span><span> )</span>
<span>            </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#b2b2b2;">$sNoExePath</span>
<span>          </span><span style="color:#2b2bff;">EndIf</span>
<span>        </span><span style="color:#2b2bff;">Else</span>
<span>          </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#b2b2b2;">$objItem</span><span>.</span><span style="color:#b2b2b2;">ExecutablePath</span>
<span>        </span><span style="color:#2b2bff;">EndIf</span>
<span>      </span><span style="color:#2b2bff;">EndIf</span>
<span>    </span><span style="color:#2b2bff;">Next</span>
<span>    </span><span style="color:#006200;">SetError</span><span> ( </span><span style="color:#b2b2b2;">$RetErr_ProcessNotFound</span><span> )</span>
<span>    </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#b2b2b2;">$sNoExePath</span>
<span>  </span><span style="color:#2b2bff;">Else</span>
<span>    </span><span style="color:#006200;">SetError</span><span> ( </span><span style="color:#b2b2b2;">$RetErr_ObjCreateErr</span><span> )</span>
<span>    </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#b2b2b2;">$sNoExePath</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>

<span>  </span><span style="color:#006200;">SetError</span><span> ( </span><span style="color:#b2b2b2;">$RetErr_UnknownErr</span><span> )</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#b2b2b2;">$sNoExePath</span>
<span style="color:#2b2bff;">EndFunc</span><span>  </span><span style="color:#363250;">;==&gt;_ProcessIdPath</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">_GetProcessCollection</span><span>()</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#2b2bff;">Const</span><span> </span><span style="color:#b2b2b2;">$wbemFlagReturnImmediately</span><span> = </span><span style="color:#8080ff;">0x10</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#2b2bff;">Const</span><span> </span><span style="color:#b2b2b2;">$wbemFlagForwardOnly</span><span> = </span><span style="color:#8080ff;">0x20</span>
<span>  </span><span style="color:#b2b2b2;">$oColItems</span><span> = </span><span style="color:#b2b2b2;">$objWMIService</span><span>.</span><span style="color:#3a7474;">ExecQuery</span><span>  ( </span><span style="color:#7a7b62;">'SELECT * FROM Win32_Process'</span><span>, </span><span style="color:#7a7b62;">'WQL'</span><span>, </span><span style="color:#b2b2b2;">$wbemFlagReturnImmediately</span><span> + </span><span style="color:#b2b2b2;">$wbemFlagForwardOnly</span><span> )</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#b2b2b2;">$oColItems</span>
<span style="color:#2b2bff;">EndFunc</span>



<span style="color:#363250;">;;;;;;functions</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">GUICtrlDeleteImage</span><span>(</span><span style="color:#b2b2b2;">$iControlID</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#2b2bff;">Const</span><span> </span><span style="color:#634880;">$IMAGE_ICON</span><span> = </span><span style="color:#8080ff;">0x0001</span>
<span>    </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$iReturn</span><span> = </span><span style="color:#006200;">GUICtrlSendMsg</span><span>(</span><span style="color:#b2b2b2;">$iControlID</span><span>, </span><span style="color:#634880;">$BM_SETIMAGE</span><span>, </span><span style="color:#634880;">$IMAGE_ICON</span><span>, </span><span style="color:#8080ff;">0</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$iReturn</span><span> = </span><span style="color:#8080ff;">0</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>        </span><span style="color:#b2b2b2;">$iReturn</span><span> = </span><span style="color:#006200;">GUICtrlSetImage</span><span>(</span><span style="color:#b2b2b2;">$iControlID</span><span>, </span><span style="color:#7a7b62;">'shell32.dll'</span><span>, -</span><span style="color:#8080ff;">50</span><span>)</span>
<span>    </span><span style="color:#2b2bff;">EndIf</span>
<span>    </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#006200;">Number</span><span>(</span><span style="color:#b2b2b2;">$iReturn</span><span> &gt; </span><span style="color:#8080ff;">0</span><span>)</span>
<span style="color:#2b2bff;">EndFunc</span><span>   </span><span style="color:#363250;">;==&gt;GUICtrlDeleteImage</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">Tt</span><span>(</span><span style="color:#634880;">$s</span><span>)</span>
<span>  </span><span style="color:#3a7474;">Tooltip</span><span>(</span><span style="color:#634880;">$s</span><span>)</span>
<span style="color:#2b2bff;">EndFunc</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">Msg</span><span>(</span><span style="color:#634880;">$s</span><span>)</span>
<span>  </span><span style="color:#006200;">MsgBox</span><span>(</span><span style="color:#8080ff;">0</span><span>,</span><span style="color:#b2b2b2;">$thisfile</span><span>,</span><span style="color:#634880;">$s</span><span>)</span>
<span style="color:#2b2bff;">EndFunc</span>

<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">ts</span><span>()</span>
<span>  </span><span style="color:#ff00ff;">Return</span><span> </span><span style="color:#ff00ff;">@YEAR&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@MON&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@MDAY&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@HOUR&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@MIN&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@SEC&amp;</span><span style="color:#939300;">&quot;.&quot;</span><span style="color:#ff00ff;">&amp;@MSEC</span>
<span style="color:#2b2bff;">EndFunc</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">logclear</span><span>()</span>
<span>  </span><span style="color:#006200;">FileDelete</span><span>(</span><span style="color:#b2b2b2;">$logg</span><span>)</span>
<span style="color:#2b2bff;">EndFunc</span>
<span style="color:#2b2bff;">Func</span><span> </span><span style="color:#3a7474;">logline</span><span>(</span><span style="color:#b2b2b2;">$line</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">Local</span><span> </span><span style="color:#b2b2b2;">$fh1</span><span>=</span><span style="color:#006200;">FileOpen</span><span>(</span><span style="color:#b2b2b2;">$logg</span><span>,</span><span style="color:#8080ff;">1</span><span>)</span><span style="color:#363250;">;</span>
<span>  </span><span style="color:#2b2bff;">If</span><span> </span><span style="color:#b2b2b2;">$fh1</span><span>&lt;&gt;-</span><span style="color:#8080ff;">1</span><span> </span><span style="color:#2b2bff;">Then</span>
<span>    </span><span style="color:#006200;">FileWriteLine</span><span>(</span><span style="color:#b2b2b2;">$fh1</span><span>,</span><span style="color:#b2b2b2;">$line</span><span>)</span>
<span>    </span><span style="color:#006200;">FileClose</span><span>(</span><span style="color:#b2b2b2;">$fh1</span><span>)</span>
<span>  </span><span style="color:#2b2bff;">EndIf</span>
<span style="color:#2b2bff;">EndFunc</span>

</pre></div>
  </body>
</html>

